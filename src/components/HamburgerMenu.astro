---
// Hamburger Menu Component for mobile navigation
import { SkewButton } from './ui';

interface Props {
	links: Array<{ href: string; label: string }>;
	currentPath: string;
}

const { links, currentPath } = Astro.props;

const isActive = (href: string) => {
	if (href === '/') return currentPath === '/';
	return currentPath.startsWith(href);
};
---

<div class="md:hidden">
	<!-- Hamburger Button -->
	<button
		class="hamburger-toggle flex flex-col gap-1.5 p-2 focus:outline-none"
		aria-label="Toggle menu"
		aria-expanded="false"
	>
		<span
			class="hamburger-line bg-mexi-white block h-0.5 w-6 origin-center transition-all duration-300"
		></span>
		<span class="hamburger-line bg-mexi-white block h-0.5 w-6 transition-all duration-300"></span>
		<span
			class="hamburger-line bg-mexi-white block h-0.5 w-6 origin-center transition-all duration-300"
		></span>
	</button>

	<!-- Mobile Menu Dropdown -->
	<div class="hamburger-menu absolute top-full right-0 left-0 hidden">
		<div class="bg-mexi-black border-b-mexi-white border-b-4">
			<ul>
				{
					links.map((link) => (
						<li>
							<a
								href={link.href}
								class:list={[
									'border-mexi-white/30 block border-b px-6 py-4 text-lg font-bold tracking-wide transition-all duration-200',
									isActive(link.href)
										? 'bg-mexi-green text-mexi-black'
										: 'text-mexi-white hover:bg-mexi-red hover:text-mexi-white'
								]}
								aria-current={isActive(link.href) ? 'page' : undefined}
							>
								{link.label}
							</a>
						</li>
					))
				}
				<!-- Mobile Book CTA -->
				<li class="bg-mexi-gray p-4">
					<SkewButton href="/booking" class="w-full justify-center">Book oss!</SkewButton>
				</li>
			</ul>
		</div>
	</div>
</div>

<script>
	document.addEventListener('astro:page-load', () => {
		const button = document.querySelector('.hamburger-toggle');
		const menu = document.querySelector('.hamburger-menu');
		const lines = document.querySelectorAll('.hamburger-line');

		button?.addEventListener('click', () => {
			const isOpen = button.getAttribute('aria-expanded') === 'true';
			button.setAttribute('aria-expanded', String(!isOpen));
			menu?.classList.toggle('hidden');

			lines[0]?.classList.toggle('rotate-45', !isOpen);
			lines[0]?.classList.toggle('translate-y-2', !isOpen);
			lines[1]?.classList.toggle('opacity-0', !isOpen);
			lines[2]?.classList.toggle('-rotate-45', !isOpen);
			lines[2]?.classList.toggle('-translate-y-2', !isOpen);
		});
	});
</script>
